---
import Base from "@/layouts/base.astro";

import { getCollection } from "astro:content";

import NewsThumbnail from "@/components/NewsThumbnail.astro";
import NewsThumbnailTwo from "@/components/NewsThumbnailTwo.astro";
import NewsThumbnailThree from "@/components/NewsThumbnailThree.astro";

// Content
// List Berita
const allBeritaPosts = await getCollection("berita");
const beritaPosts = allBeritaPosts.sort(
    (a, b) => b.data.postDate.getTime() - a.data.postDate.getTime(),
);
const latestBeritaPost = beritaPosts.slice(0, 3);
const threeLastBeritaPosts = beritaPosts.slice(1, 4);

// List Pengumuman
const allPengumumanPosts = await getCollection("pengumuman");
const pengumumanPosts = allPengumumanPosts.sort(
    (a, b) => b.data.postDate.getTime() - a.data.postDate.getTime(),
);
const pengumumanLastest = pengumumanPosts.slice(0, 6);

// List Artikel
const allArtikelPosts = await getCollection("artikel");
const artikelPosts = allArtikelPosts.sort(
    (a, b) => b.data.postDate.getTime() - a.data.postDate.getTime(),
);
const latestArticlePost = artikelPosts.slice(0, 1);
const threeLastArticlePosts = artikelPosts.slice(1, 4);

// List Gallery
const allGaleriPosts = await getCollection("galeri"); // List photo
const galeriPosts = allGaleriPosts.sort(
    (a, b) => b.data.postDate.getTime() - a.data.postDate.getTime(),
);
const lastGaleri = galeriPosts.slice(0, 3);

const newsThumbSize = (position: number) =>
    position === 0
        ? "lg:col-span-3 lg:row-span-1"
        : "lg:row-span-1 lg:col-span-1";
---

<Base title="Beranda">
    <div class="container flex gap-4">
        <div class="lg:w-3/4">
            <h2>Berita Terkini</h2>
            <ul class="lg:grid grid-cols-3 grid-rows-2 grid-flow-row-dense gap-4">
                {
                    latestBeritaPost.map((post, idx) => (
                        <>
                            {idx === 0 ? (
                                <li class="col-span-2 row-span-2 col-start-2 row-start-1 border-l lg:pl-4">
                                    <div class="w-full aspect-[16/10] bg-red-500"></div>
                                    <h2>{post.data.title}</h2>
                                </li>
                            ) : (
                                <li class="col-start-1">
                                    <div class="w-full aspect-[16/10] bg-red-500"></div>
                                    <h2>{post.data.title}</h2>
                                </li>
                            )}
                        </>
                    ))
                }
            </ul>
        </div>
        <div class="border-l"></div>
        <div class="lg:w-1/4">
            <h2>Pengumuman</h2>
        </div>
    </div>
</Base>
